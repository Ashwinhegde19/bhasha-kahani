<!DOCTYPE html>
<html>
<head>
    <title>Audio Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: 0 auto; }
        button { padding: 10px 20px; font-size: 16px; cursor: pointer; margin: 10px 0; }
        #status { margin: 20px 0; padding: 10px; background: #f0f0f0; border-radius: 5px; }
        .success { color: green; }
        .error { color: red; }
        audio { width: 100%; margin-top: 20px; }
    </style>
</head>
<body>
    <h1>Bhasha Kahani - Audio Test</h1>
    <div id="status">Click button to test...</div>
    <button onclick="testAudio()">Test Audio API</button>
    <button onclick="testStories()">Test Stories API</button>
    <div id="result"></div>

    <script>
        const API_URL = 'http://localhost:8000';
        
        function updateStatus(msg, isError = false) {
            document.getElementById('status').innerHTML = `<span class="${isError ? 'error' : 'success'}">${msg}</span>`;
        }

        async function testStories() {
            updateStatus('Fetching stories...');
            try {
                const response = await fetch(`${API_URL}/stories`);
                const data = await response.json();
                updateStatus(`Success! Found ${data.data.length} stories`);
                document.getElementById('result').innerHTML = `<pre>${JSON.stringify(data.data[0], null, 2)}</pre>`;
            } catch (e) {
                updateStatus('Error: ' + e.message, true);
            }
        }

        async function testAudio() {
            updateStatus('Fetching audio...');
            try {
                const response = await fetch(`${API_URL}/audio/448e3640-bcd9-4f83-907a-a74eddc3ed8a?language=en&speaker=meera`);
                const data = await response.json();
                updateStatus(`Success! Audio URL received`);
                document.getElementById('result').innerHTML = `
                    <p><strong>Audio URL:</strong></p>
                    <a href="${data.audio_url}" target="_blank">${data.audio_url}</a>
                    <audio controls src="${data.audio_url}"></audio>
                `;
            } catch (e) {
                updateStatus('Error: ' + e.message, true);
            }
        }
    </script>
</body>
</html>
